{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>EnterPrice - Store Profile</title>
    <link rel="icon" href="{% static "home/icons/logo-lg.png" %}" type="image/x-icon">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css">
    <link rel="stylesheet" href="{% static "css/navbar-theme.css" %}">
    <link rel="stylesheet" href="{% static "css/core-theme.css" %}">
    <link rel="stylesheet" href="{% static "store_review/css/profile-theme.css" %}">
    <link rel="stylesheet" href="{% static "store_review/css/rating-theme.css" %}">


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<style>
 body {
     background: url({% static "wallpapers/art.jpg" %}) fixed no-repeat;
     background-position: center;
     background-size: cover;
 }

 .ml {
    margin-left: 25px;
 }

 .container-margin {
    margin: 50px 200px;
 }

    @media screen and (max-width:1170px) {
        .ml {
            margin-left: 0px;
        }
    }

    @media screen and (max-width:768px) {

        .container-margin {
            margin: 50px 0;
        }
    }
</style>
<body>
    {% include 'navbar.html' %}
    <div class="container-fluid container-margin">
        <div class="col-xs-12 col-md-5 col-lg-3 col-lg-offset-1">
            <div class="thumbnail">
                <div class="caption text-center"></div>

                <div class="position-relative text-center">
                    <img class="img-size-sm" src="{% static store.store_image %}"
                         style="margin-bottom: 10px; border-radius: 50%; border:4px solid black;">
                </div>

                <div class="thumbnail-description">
                    <hr>
                    <div class="text-center">
                        <h3><i class="fa fa-info-circle" style="color:#315b96"></i> Info</h3>
                    </div>
                    <div class="text-center">
                        <ul class="list-group">
                            {% autoescape on %}
                                <li class="list-group-item">Store Name: {{store.store_name}}</li>
                                {% if average_rating > 0 %}
                                    <li class="list-group-item">Average Rating: {{average_rating}} / 5</li>
                                {% else %}
                                    <li class="list-group-item">Average Rating: -</li>
                                {% endif %}
                                <li class="list-group-item">Contact: {{store.email}}</li>
                                <li class="list-group-item">Location: {{store.address}}, {{store.city}}</li>
                            {% endautoescape %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>


        {% if store_reviews|length > 0 %}
            {% for review in store_reviews %}
                <div class="thumbnail col-xs-12 col-md-7 col-lg-6 col-lg-offset-1 ml">
                    <div class="row">
                        <div class="col-sm-12">
                            {% if review.customer.username == username %}
                                <div class="pull-right" style="margin-top: 5px; margin-right: 10px">
                                    <a href="{% url 'delete-review' review.purchase.purchase_id %}"
                                       class="text-dark">
                                        <i class="fa fa-times fa-lg"></i>
                                    </a>
                                </div>
                                <div class="pull-right" style="margin-top: 5px; margin-right: 10px">
                                    <a href="{% url 'write-review' review.purchase.purchase_id %}"
                                       class="text-dark">
                                        <i class="fa fa-edit fa-lg"></i>
                                    </a>
                                </div>
                            {% endif %}
                            <div class="review-block">
                                <div class="row">
                                    <div class="col-sm-4">
                                        <div class="text-center">
                                            <img src="{% static review.customer.user_image %}"
                                                 style="border-radius:50%; border: 3px solid black;
                                                 max-width:68px; max-height:68px">
                                            <div class="review-block-name" style="margin-top: 8px">
                                                {{review.customer.fullname|escape}}
                                            </div>
                                            <div class="review-block-date">
                                                {{review.purchase.purchase_date}}
                                            </div>
                                            <div style="margin-top: 15px">
                                                <i>Purchase ID: {{review.purchase.purchase_id}}</i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-8" style="margin: 10px 0">
                                        <div class="review-block-rate">
                                            {% for i in stars %}
                                                {% if i <= review.rating %}
                                                    <button type="button" class="btn btn-primary btn-xs" aria-label="Left Align">
                                                        <span class="glyphicon glyphicon-star" aria-hidden="true"></span>
                                                    </button>
                                                {% else %}
                                                    <button type="button" class="btn btn-default btn-grey btn-xs" aria-label="Left Align">
                                                        <span class="glyphicon glyphicon-star" aria-hidden="true"></span>
                                                    </button>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <div style="font-size:15px">{{review.review_body|escape}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div class="thumbnail col-xs-12 col-md-7 col-lg-6 ml">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="text-center">
                                <img src="{% static "home/icons/sad-face.png" %}"/>
                                <div class="alert text-center"
                                     style="margin-top:3px; font-size:16px; background-color:aliceblue"
                                     role="alert">
                                    <h3>There are no reviews yet for {{store.store_name|escape}}!</h3>
                                </div>
                            </div>
                        </div>
                    </div>
            </div>
        {% endif %}

</div><!--container-end -->
{% include 'footer.html' %}
</body>
</html>